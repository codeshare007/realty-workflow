<div [@routerTransition]>
    <div class="content d-flex flex-column flex-column-fluid">
        <sub-header [title]="'Communications' | localize">
            <div role="pre-description">
                <!--begin::Mobile Toggle-->
                <button class="burger-icon burger-icon-left mr-4 d-inline-block d-lg-none" type="button"
                    id="kt_subheader_mobile_toggle">
                    <span></span>
                </button>
                <!--end::Mobile Toggle-->
            </div>
            <div role="actions">
                <button class="btn btn-primary" type="button" (click)="settingsModal.show()">
                    <i class="fas fa-cog"></i>
                    {{'Settings' | localize}}
                </button>
            </div>
        </sub-header>

        <div [class]="containerClass" [busyIf]="loading">
            <!--begin::Inbox-->
            <div class="d-flex flex-row">
                <comms-inbox-aside [items]="items" *ngIf="items.length" (itemSelected)="topicSelected($event)">
                </comms-inbox-aside>
                <comms-inbox-view *ngIf="selectedTopic?.contact" class="flex-row-fluid ml-lg-8 d-block"
                    [contact]="selectedTopic.contact"></comms-inbox-view>
            </div>
            <!--end::Inbox-->
            <!--begin::Compose-->
            <div class="modal modal-sticky modal-sticky-lg modal-sticky-bottom-right" id="kt_inbox_compose"
                data-backdrop="false" style="display: none;" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <!--begin::Form-->
                        <form id="kt_inbox_compose_form">
                            <!--begin::Header-->
                            <div class="d-flex align-items-center justify-content-between py-5 pl-8 pr-5 border-bottom">
                                <h5 class="font-weight-bold m-0">Compose</h5>
                                <div class="d-flex ml-2">
                                    <span class="btn btn-clean btn-sm btn-icon mr-2">
                                        <i class="flaticon2-arrow-1 icon-1x"></i>
                                    </span>
                                    <span class="btn btn-clean btn-sm btn-icon" data-dismiss="modal">
                                        <i class="ki ki-close icon-1x"></i>
                                    </span>
                                </div>
                            </div>
                            <!--end::Header-->
                            <!--begin::Body-->
                            <div class="d-block">
                                <!--begin::To-->
                                <div class="d-flex align-items-center border-bottom inbox-to px-8 min-h-45px">
                                    <div class="text-dark-50 w-75px">To:</div>
                                    <div class="d-flex align-items-center flex-grow-1">
                                        <div class="tagify form-control border-0" tabindex="-1">
                                            <div title="Chris Muller" spellcheck="false" tabindex="-1"
                                                class="tagify__tag tagify__tag--primary tagify--noAnim" __isvalid="true"
                                                pic="./assets/media/users/100_11.jpg" initialsstate="" initials=""
                                                email="chris.muller@wix.com" value="Chris Muller"
                                                contenteditable="false">
                                                <div title="" class="tagify__tag__removeBtn" role="button"
                                                    aria-label="remove tag"></div>
                                                <div><span class="tagify__tag-text">Chris Muller</span></div>
                                            </div>
                                            <div title="Lina Nilson" spellcheck="false" tabindex="-1"
                                                class="tagify__tag tagify__tag--primary tagify--noAnim" __isvalid="true"
                                                pic="./assets/media/users/100_15.jpg" initialsstate="danger"
                                                initials="LN" email="lina.nilson@loop.com" value="Lina Nilson"
                                                contenteditable="false">
                                                <div title="" class="tagify__tag__removeBtn" role="button"
                                                    aria-label="remove tag"></div>
                                                <div><span class="tagify__tag-text">Lina Nilson</span></div>
                                            </div><span data-placeholder="​" aria-placeholder="" class="tagify__input"
                                                role="textbox" aria-autocomplete="both" aria-multiline="false"
                                                contenteditable=""></span>
                                        </div><input type="text" class="form-control border-0" name="compose_to"
                                            value="Chris Muller, Lina Nilson">
                                    </div>
                                    <div class="ml-2">
                                        <span class="text-muted font-weight-bold cursor-pointer text-hover-primary mr-2"
                                            data-inbox="cc-show">Cc</span>
                                        <span class="text-muted font-weight-bold cursor-pointer text-hover-primary"
                                            data-inbox="bcc-show">Bcc</span>
                                    </div>
                                </div>
                                <!--end::To-->
                                <!--begin::CC-->
                                <div class="d-none align-items-center border-bottom inbox-to-cc pl-8 pr-5 min-h-45px">
                                    <div class="text-dark-50 w-75px">Cc:</div>
                                    <div class="flex-grow-1">
                                        <div class="tagify form-control border-0 tagify--noTags tagify--empty"
                                            tabindex="-1">
                                            <span data-placeholder="​" aria-placeholder="" class="tagify__input"
                                                role="textbox" aria-autocomplete="both" aria-multiline="false"
                                                contenteditable=""></span>
                                        </div><input type="text" class="form-control border-0" name="compose_cc"
                                            value="">
                                    </div>
                                    <span class="btn btn-clean btn-xs btn-icon" data-inbox="cc-hide">
                                        <i class="la la-close"></i>
                                    </span>
                                </div>
                                <!--end::CC-->
                                <!--begin::BCC-->
                                <div class="d-none align-items-center border-bottom inbox-to-bcc pl-8 pr-5 min-h-45px">
                                    <div class="text-dark-50 w-75px">Bcc:</div>
                                    <div class="flex-grow-1">
                                        <div class="tagify form-control border-0 tagify--noTags tagify--empty"
                                            tabindex="-1">
                                            <span data-placeholder="​" aria-placeholder="" class="tagify__input"
                                                role="textbox" aria-autocomplete="both" aria-multiline="false"
                                                contenteditable=""></span>
                                        </div><input type="text" class="form-control border-0" name="compose_bcc"
                                            value="">
                                    </div>
                                    <span class="btn btn-clean btn-xs btn-icon" data-inbox="bcc-hide">
                                        <i class="la la-close"></i>
                                    </span>
                                </div>
                                <!--end::BCC-->
                                <!--begin::Subject-->
                                <div class="border-bottom">
                                    <input class="form-control border-0 px-8 min-h-45px" name="compose_subject"
                                        placeholder="Subject">
                                </div>
                                <!--end::Subject-->
                                <!--begin::Message-->
                                <div class="ql-toolbar ql-snow px-5 border-top-0 border-left-0 border-right-0"><span
                                        class="ql-formats"><span class="ql-header ql-picker"><span
                                                class="ql-picker-label" tabindex="0" role="button" aria-expanded="false"
                                                aria-controls="ql-picker-options-1"><svg viewBox="0 0 18 18">
                                                    <polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"></polygon>
                                                    <polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"></polygon>
                                                </svg></span><span class="ql-picker-options" aria-hidden="true"
                                                tabindex="-1" id="ql-picker-options-1"><span tabindex="0" role="button"
                                                    class="ql-picker-item" data-value="1"></span><span tabindex="0"
                                                    role="button" class="ql-picker-item" data-value="2"></span><span
                                                    tabindex="0" role="button" class="ql-picker-item"
                                                    data-value="3"></span><span tabindex="0" role="button"
                                                    class="ql-picker-item ql-selected"></span></span></span><select
                                            class="ql-header" style="display: none;">
                                            <option value="1"></option>
                                            <option value="2"></option>
                                            <option value="3"></option>
                                            <option selected="selected"></option>
                                        </select></span><span class="ql-formats"><button type="button"
                                            class="ql-bold"><svg viewBox="0 0 18 18">
                                                <path class="ql-stroke"
                                                    d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z">
                                                </path>
                                                <path class="ql-stroke"
                                                    d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z">
                                                </path>
                                            </svg></button><button type="button" class="ql-italic"><svg
                                                viewBox="0 0 18 18">
                                                <line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"></line>
                                                <line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"></line>
                                                <line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"></line>
                                            </svg></button><button type="button" class="ql-underline"><svg
                                                viewBox="0 0 18 18">
                                                <path class="ql-stroke"
                                                    d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"></path>
                                                <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3"
                                                    y="15"></rect>
                                            </svg></button><button type="button" class="ql-link"><svg
                                                viewBox="0 0 18 18">
                                                <line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"></line>
                                                <path class="ql-even ql-stroke"
                                                    d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z">
                                                </path>
                                                <path class="ql-even ql-stroke"
                                                    d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z">
                                                </path>
                                            </svg></button></span><span class="ql-formats"><button type="button"
                                            class="ql-list" value="ordered"><svg viewBox="0 0 18 18">
                                                <line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"></line>
                                                <line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"></line>
                                                <line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"></line>
                                                <line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5">
                                                </line>
                                                <path class="ql-fill"
                                                    d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z">
                                                </path>
                                                <path class="ql-stroke ql-thin"
                                                    d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156">
                                                </path>
                                                <path class="ql-stroke ql-thin"
                                                    d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109">
                                                </path>
                                            </svg></button><button type="button" class="ql-list" value="bullet"><svg
                                                viewBox="0 0 18 18">
                                                <line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"></line>
                                                <line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"></line>
                                                <line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"></line>
                                                <line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"></line>
                                                <line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"></line>
                                                <line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"></line>
                                            </svg></button></span><span class="ql-formats"><button type="button"
                                            class="ql-clean"><svg class="" viewBox="0 0 18 18">
                                                <line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"></line>
                                                <line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"></line>
                                                <line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"></line>
                                                <line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"></line>
                                                <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2"
                                                    y="14"></rect>
                                            </svg></button></span></div>
                                <div id="kt_inbox_compose_editor" class="border-0 ql-container ql-snow"
                                    style="height: 250px">
                                    <div class="ql-editor ql-blank px-8" data-gramm="false"
                                        data-placeholder="Type message..." contenteditable="true">
                                        <p><br></p>
                                    </div>
                                    <div class="ql-clipboard" tabindex="-1" contenteditable="true"></div>
                                    <div class="ql-tooltip ql-hidden"><a class="ql-preview" rel="noopener noreferrer"
                                            target="_blank" href="about:blank"></a><input type="text"
                                            data-formula="e=mc^2" data-link="https://quilljs.com"
                                            data-video="Embed URL"><a class="ql-action"></a><a class="ql-remove"></a>
                                    </div>
                                </div>
                                <!--end::Message-->
                                <!--begin::Attachments-->
                                <div class="dropzone dropzone-multi px-8 py-4" id="kt_inbox_compose_attachments">
                                    <div class="dropzone-items">

                                    </div>
                                    <div class="dz-default dz-message"><button class="dz-button" type="button">Drop
                                            files here to upload</button></div>
                                </div>
                                <!--end::Attachments-->
                            </div>
                            <!--end::Body-->
                            <!--begin::Footer-->
                            <div class="d-flex align-items-center justify-content-between py-5 pl-8 pr-5 border-top">
                                <!--begin::Actions-->
                                <div class="d-flex align-items-center mr-3">
                                    <!--begin::Send-->
                                    <div class="btn-group mr-4">
                                        <span class="btn btn-primary font-weight-bold px-6">Send</span>
                                        <span
                                            class="btn btn-primary font-weight-bold dropdown-toggle dropdown-toggle-split"
                                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"
                                            role="button"></span>
                                        <div class="dropdown-menu dropdown-menu-sm dropup p-0 m-0 dropdown-menu-right">
                                            <ul class="navi py-3">
                                                <li class="navi-item">
                                                    <a href="#" class="navi-link">
                                                        <span class="navi-icon">
                                                            <i class="flaticon2-writing"></i>
                                                        </span>
                                                        <span class="navi-text">Schedule Send</span>
                                                    </a>
                                                </li>
                                                <li class="navi-item">
                                                    <a href="#" class="navi-link">
                                                        <span class="navi-icon">
                                                            <i class="flaticon2-medical-records"></i>
                                                        </span>
                                                        <span class="navi-text">Save &amp; archive</span>
                                                    </a>
                                                </li>
                                                <li class="navi-item">
                                                    <a href="#" class="navi-link">
                                                        <span class="navi-icon">
                                                            <i class="flaticon2-hourglass-1"></i>
                                                        </span>
                                                        <span class="navi-text">Cancel</span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <!--end::Send-->
                                    <!--begin::Other-->
                                    <span class="btn btn-icon btn-sm btn-clean mr-2 dz-clickable"
                                        id="kt_inbox_compose_attachments_select">
                                        <i class="flaticon2-clip-symbol"></i>
                                    </span>
                                    <span class="btn btn-icon btn-sm btn-clean">
                                        <i class="flaticon2-pin"></i>
                                    </span>
                                    <!--end::Other-->
                                </div>
                                <!--end::Actions-->
                                <!--begin::Toolbar-->
                                <div class="d-flex align-items-center">
                                    <span class="btn btn-icon btn-sm btn-clean mr-2" data-toggle="tooltip" title=""
                                        data-original-title="More actions">
                                        <i class="flaticon2-settings"></i>
                                    </span>
                                    <span class="btn btn-icon btn-sm btn-clean" data-inbox="dismiss"
                                        data-toggle="tooltip" title="" data-original-title="Dismiss reply">
                                        <i class="flaticon2-rubbish-bin-delete-button"></i>
                                    </span>
                                </div>
                                <!--end::Toolbar-->
                            </div>
                            <!--end::Footer-->
                        </form>
                        <!--end::Form-->
                    </div>
                </div>
            </div>
            <!--end::Compose-->
        </div>
    </div>
</div>

<comms-settings-modal #settingsModal (modalSave)="getItems()"></comms-settings-modal>
